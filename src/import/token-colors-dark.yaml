vars:
  colors:
    tc:
      black: $colors.black
      white: $colors.white
      grey: mix($colors.tc.black, $colors.tc.white)
      blue: darken(mix($colors.blue, $colors.tc.white, 40), 20)
      red: darken(mix($colors.red, $colors.tc.white, 40), 20)
      yellow: darken(mix($colors.yellow, $colors.tc.white, 40), 20)
      orange: darken(mix($colors.orange, $colors.tc.white, 40), 20)
      green: darken(mix($colors.green, $colors.tc.white, 40), 20)
      purple: darken(mix($colors.purple, $colors.tc.white, 40), 20)
      pink: darken(mix($colors.pink, $colors.tc.white, 40), 20)
      teal: darken(mix($colors.teal, $colors.tc.white, 40), 20)
      gold: darken(mix($colors.gold, $colors.tc.white, 40), 20)
      peach: oklch(0.7 0.1 30)

  scope:
    # Basic structural elements
    comment: $colors.tc.grey
    text: $colors.tc.blue
    punctuation: $colors.tc.blue
    baseText: $colors.tc.white

    # Universal "self" concepts (this, self, base, super)
    selfRef: $colors.tc.peach

    # Universal literals
    string: $colors.tc.green
    number: $colors.tc.blue
    boolean: $colors.tc.green

    # Universal identifiers
    variable: $colors.tc.blue
    parameter: $colors.tc.blue
    property: darken($colors.tc.pink, 20)
    constant: $colors.tc.green

    # Universal callables
    function: $colors.tc.orange
    method: $colors.tc.orange

    # Universal type system
    types: $colors.tc.green
    class: $colors.tc.gold
    namespace: $colors.tc.gold

    # Universal language constructs
    keyword: $colors.tc.purple
    storage: $colors.tc.blue
    storage.modifier: $colors.tc.purple
    operator: $colors.tc.yellow
    operator2: $colors.tc.purple

    # Universal structural
    attribute: darken($colors.tc.gold, 30)
    declaration: $colors.tc.gold
    embeddedLanguage: $colors.tc.gold

    # Markup and documentation
    header: $colors.tc.orange
    code: $colors.teal
    link: $colors.tc.gold

    # String interpolation (different from strings)
    interpolation: $colors.tc.purple

    # Language-specific snowflakes
    rustOwnership: $colors.tc.purple
    rubyGlobal: $colors.tc.orange
    rubyClass: $colors.tc.blue
    rubyInstance: $colors.tc.blue
    rubyLocal: $colors.tc.green

    # CSS-specific
    cssSelector: $colors.tc.purple
    cssProperty: $colors.tc.green
    cssValue: $colors.tc.blue

    # Legacy/migration
    text2: $colors.tc.grey
    constant2: $colors.tc.gold
    className: $colors.tc.orange
    self: $colors.tc.peach

theme:
  tokenColors:
    - settings:
        foreground: $scope.text

    # #########################################################################
    # Makefile
    # #########################################################################

    - name: Makefile Prerequisites
      scope: meta.scope.prerequisites.makefile
      settings:
        foreground: $scope.declaration
    - name: Makefile Recipe
      scope: meta.scope.recipe.makefile
      settings:
        foreground: $scope.constant

    # #########################################################################
    # Markdown/Markup
    # #########################################################################

    - name: Markdown bold
      scope: markup.bold.markdown
      settings:
        fontStyle: bold

    - name: Markdown italic
      scope: markup.italic.markdown
      settings:
        fontStyle: italic

    - name: Markdown Header
      scope: markup.heading
      settings:
        fontStyle: bold

    # #########################################################################
    # General scopes that apply across many/most languages agnostically.
    #
    # This is last because of specificity by order of appearance. Scopes
    # defined here will not match if there is a more language-specific match
    # earlier. You want those to match because they're more unique to that
    # language.
    # #########################################################################

    - name: Plain Text
      scope: meta.paragraph, text.html, meta.jsx.children, doctype
      settings:
        foreground: $scope.baseText

    - name: Control Keywords (if/for/return/etc)
      scope: keyword.control, meta.at-rule,
        meta.var.expr keyword.control.export, keyword.other.using,
        meta.preprocessor,
        keyword.other.namespace, keyword.preprocessor,
        keyword.other.special-method, def.meta, meta.require,
        keyword.other.crate, meta.use, keyword.package, keyword.function,
        keyword.interface, entity.name.goto-label
      settings:
        foreground: $colors.tc.pink

    - name: Self/This/etc
      scope: variable.parameter.function.language.special.self,
        variable.language.special.self, this.class.meta, storage.modifier.this
      settings:
        foreground: $scope.selfRef

    - name: Quoted Strings
      scope: string.quoted, string.unquoted.heredoc,
        jsx.children.objectliteral.expression.embedded.tag.string.block,
        meta.string-contents
      settings:
        foreground: $scope.string

    - name: Functions/Methods
      scope: entity.name.function, meta.definition.method,
        support.function, function.meta, function-call
      settings:
        foreground: $scope.function

    - name: Code Snippets
      scope: markup.inline.raw, markup.fenced_code.block
      settings:
        foreground: $scope.code

    - name: Embedded Languages
      scope: source.sql.embedded, source.js.embedded, source.css.embedded
      settings:
        foreground: $scope.embeddedLanguage

    - name: Links
      scope: string.other.link.description, meta.image.inline,
        meta.link, string.other.link.title
      settings:
        foreground: $scope.link

    - name: Storage
      scope: support.module.node, storage.type.primitive.var
      settings:
        foreground: $scope.keyword

    - name: Storage types
      scope: entity.name.variable.enum-member, keyword.declaration.abstract,
        keyword.declaration.class, keyword.declaration.enum,
        keyword.declaration.extends, keyword.declaration.extension,
        keyword.declaration.get, keyword.declaration.implements,
        keyword.declaration.on, keyword.declaration.set,
        keyword.declaration.typedef, keyword.declaration.with,
        keyword.other.class, keyword.other.delegate,
        keyword.other.enum, keyword.other.event, keyword.other.fn,
        keyword.other.interface, keyword.struct, keyword.type,
        meta.namespace.declaration, storage.type.annotation,
        storage.type.numeric, storage.type.primitive, declaration.keyword
      settings:
        foreground: $scope.declaration

    - name: Storage Modifiers (async, const, etc)
      scope: storage.modifier, storage.type.accessor, keyword.other
      settings:
        foreground: $scope.storage.modifier

    - name: Number
      scope: constant.numeric, entity.other.keyframe-offset
      settings:
        foreground: $scope.number

    - name: Variables
      scope: var-single-variable.variable.readwrite.other.meta,
        support.variable.object.process, entity.name.variable,
        class.variable, instance.variable, global.variable
      settings:
        foreground: $scope.variable

    - name: Constants
      scope: constant.other.placeholder,
        constant.other.variable.mac-classic, constant.other.caps
      settings:
        foreground: $scope.constant

    - name: Built-in constant
      scope: support.variable.object.node, support.constant,
        constant.character.format.placeholder.other
      settings:
        foreground: $scope.constant

    - name: Module Name
      scope: module.meta, function.object.block.variable.meta,
        entity.name.type.module, support.type.object.module,
        entity.name.type.namespace, entity.name.namespace,
        entity.name.module, entity.name.package
      settings:
        foreground: $scope.namespace

    - name: Type Names
      scope: storage.type.built-in, meta.type.annotation, support.type.cocoa,
        meta.argument-type, meta.protocol-list
      settings:
        foreground: $scope.types

    - name: String Interpolation Begin and End
      scope: begin.expression.string, end.expression.string,
        punctuation.definition.template-expression.begin,
        punctuation.definition.template-expression.end,
        embedded.begin.string.punctuation,
        embedded.end.string.punctuation
      settings:
        foreground: $scope.interpolation

    - name: String Interpolation Body
      scope: expression.string, embedded.string.punctuation
      settings:
        foreground: $scope.interpolation

    - name: User-defined constant
      scope: variable.other.constant, character.constant.entity
      settings:
        foreground: $scope.constant

    - name: Parameters
      scope: variable.parameter, function.parameters.entity.name.meta,
        variable.other.macro.argument
      settings:
        foreground: $scope.parameter

    # #########################################################################
    # Classes
    # #########################################################################

    - name: Class names
      scope: entity.name.class, entity.name.type.class,
        meta.function-call.static, meta.function-call.object,
        support.other.namespace.use
      settings:
        foreground: $scope.class

    - name: Class Super
      scope: super.meta, support.class.super,
        meta.inheritance-clause
      settings:
        foreground: $scope.selfRef

    - name: Inherited Class
      scope: entity.other.inherited-class
      settings:
        foreground: $scope.class

    # #########################################################################
    # Tagging/Attributes
    # #########################################################################

    - name: Tag name
      scope: punctuation.definition.tag, entity.name.tag
      settings:
        foreground: $scope.punctuation

    - name: Tag attribute
      scope: entity.other.attribute-name, meta.tag.attributes,
        name.tag.out.plain.unquoted.string.entity
      settings:
        foreground: $scope.attribute

    # #########################################################################
    # RegExp
    # #########################################################################

    - name: RegExp Group Punctuation
      scope: punctuation.definition.group.regexp,
        punctuation.definition.group.no-capture.regexp
      settings:
        foreground: $scope.punctuation

    - name: RegExp Character Class Punctuation
      scope: punctuation.definition.character-class.regexp
      settings:
        foreground: $scope.punctuation

    - name: RegExp Character Class Constants
      scope: constant.other.character-class.regexp,
        constant.other.character-class.set.regexp
      settings:
        foreground: $scope.constant

    - name: RegExp Numeric Escapes
      scope: constant.character.numeric.regexp
      settings:
        foreground: $scope.number

    # #########################################################################
    # Properties
    # #########################################################################

    - name: Property Names
      scope: support.type.property-name, support.type.vendored.property-name,
        meta.property-name, variable.other.property,
        support.variable.property, property.field.declaration.class.meta
      settings:
        foreground: $scope.property
        fontStyle: bold

    # #########################################################################
    # Operators for all of the languages
    # #########################################################################

    - name: Operators
      scope: keyword.operator.new, keyword.operator.expression,
        keyword.operator.word.new, keyword.operator.namespace,
        keyword.operator.borrow.and,
        keyword.operator.dereference,
        keyword.operator.key-value,
        keyword.operator.access.dot,
        keyword.operator.bitwise,
        keyword.operator.address
      settings:
        foreground: $scope.operator

    - name: Arithmetic Operators
      scope: keyword.operator.arithmetic
      settings:
        foreground: $scope.operator

    - name: Assignment Operator
      scope: keyword.operator.assignment, punctuation.separator.key-value
      settings:
        foreground: $scope.operator

    - name: Logical Operators
      scope: keyword.operator.logical, keyword.operator.or.regexp,
        keyword.operator.negation.regexp
      settings:
        foreground: $scope.operator
        fontStyle: bold

    - name: General Keyword Operators
      scope: keyword.operator, operator
      settings:
        foreground: $scope.operator

    # #########################################################################
    # Universal fallback rules for common patterns
    # #########################################################################

    - name: Universal Comments
      scope: comment, punctuation.definition.comment
      settings:
        foreground: $scope.comment
        fontStyle: italic

    - name: Universal Self References
      scope: variable.language.self, variable.language.this,
        variable.language.base, variable.language.super
      settings:
        foreground: $scope.selfRef

    - name: Universal Booleans
      scope: constant.language.boolean, constant.language.null
      settings:
        foreground: $scope.boolean

    - name: Universal String Interpolation
      scope: punctuation.definition.template-expression,
        string.interpolated.expression, punctuation.definition.variable,
        punctuation.section.embedded.begin, punctuation.section.embedded.end
      settings:
        foreground: $scope.interpolation

    - name: Universal Punctuation
      scope: punctuation, begin.brace, end.brace
      settings:
        foreground: $scope.punctuation

    # #########################################################################
    # Semantic Fallbacks - When semantic highlighting is disabled/unavailable
    # These provide broad semantic token support as fallbacks
    # #########################################################################

    - name: Semantic Types Fallback
      scope: namespace, class, enum, interface, struct, typeParameter, type
      settings:
        foreground: $scope.types

    - name: Semantic Callables Fallback
      scope: function, method, macro
      settings:
        foreground: $scope.function

    - name: Semantic Identifiers Fallback
      scope: parameter, property, enumMember, decorator, event
      settings:
        foreground: $scope.variable

    - name: Semantic Literals Fallback
      scope: number, regexp
      settings:
        foreground: $scope.number

    - name: Semantic Keywords Fallback
      scope: keyword.declaration, label
      settings:
        foreground: $scope.keyword

    # #########################################################################
    # Final Fallbacks - Broadest possible scopes (NEVER override anything)
    # These are last resort matchers for any unmatched tokens
    # #########################################################################

    - name: Final Fallback - Base Source
      scope: source
      settings:
        foreground: $scope.baseText

    - name: Final Fallback - Generic Keyword
      scope: keyword
      settings:
        foreground: $scope.keyword

    - name: Final Fallback - Generic Variable
      scope: variable
      settings:
        foreground: $scope.variable

    - name: Final Fallback - Generic Constant
      scope: constant
      settings:
        foreground: $scope.constant

    - name: Final Fallback - String Constant
      scope: string
      settings:
        foreground: $scope.string

    - name: Final Fallback - Storage types
      scope: storage.type
      settings:
        foreground: $scope.declaration

    - name: Final Fallback - Storage
      scope: storage
      settings:
        foreground: $scope.storage

    - name: Final Fallback - Entity Types
      scope: entity.name.type
      settings:
        foreground: $scope.types

    - name: Final Fallback - Type Names
      scope: support.type
      settings:
        foreground: $scope.types

    - name: Final Fallback - Type Names
      scope: meta.function-call
      settings:
        foreground: $scope.parameter

    - name: Final Fallback - Class names
      scope: support.class
      settings:
        foreground: $scope.class
